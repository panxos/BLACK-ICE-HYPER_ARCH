# BLACK-ICE ARCH - Hyprland Configuration (3.3 Optimized)

# Monitor
monitor=,preferred,auto,auto

# Session Stability & Environment Sync
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP

# Autostart Components
# Autostart Components (ORCHESTRATED)
exec-once = ~/.config/hypr/scripts/startup.sh
exec-once = dunst
exec-once = /usr/lib/polkit-kde-authentication-agent-1
exec-once = nm-applet --indicator
exec-once = blueman-applet
exec-once = xdg-user-dirs-update


# GTK Theme & Appearance (FORCED DARK MODE)
exec-once = gsettings set org.gnome.desktop.interface gtk-theme 'Sweet-Dark'
exec-once = gsettings set org.gnome.desktop.interface icon-theme 'candy-icons'
exec-once = gsettings set org.gnome.desktop.interface font-name 'Roboto Medium 10'
exec-once = gsettings set org.gnome.desktop.interface cursor-theme 'Breeze_Snow'
exec-once = gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
exec-once = gsettings set org.gnome.desktop.appearance color-scheme 'prefer-dark'

# KDE/Qt Theme Configuration (FORCED DARK MODE)
# exec-once = kvantummanager --set Sweet-Dark 2>/dev/null || true # Removed to prevent GUI popup

# Global Environment Variables
env = XCURSOR_SIZE,24
env = BROWSER,brave
env = XDG_CURRENT_DESKTOP,GNOME
env = DE,gnome
env = _JAVA_AWT_WM_NONREPARENTING,1

# UI Scaling Fix (FORCE 1.0)
env = GDK_SCALE,1
env = GDK_DPI_SCALE,1
env = QT_AUTO_SCREEN_SCALE_FACTOR,0
env = QT_ENABLE_HIGHDPI_SCALING,0

# Qt/KDE Theme Configuration (FORCE DARK MODE)
env = QT_QPA_PLATFORMTHEME,qt6ct
env = QT_STYLE_OVERRIDE,kvantum
env = QT_QUICK_CONTROLS_STYLE,org.kde.desktop
env = KDE_SESSION_VERSION,6
env = KDE_FULL_SESSION,true
env = XDG_CURRENT_DESKTOP,Hyprland
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP QT_QPA_PLATFORMTHEME KDE_SESSION_VERSION BROWSER _JAVA_AWT_WM_NONREPARENTING DE

# Input Configuration
input {
    kb_layout = es
    follow_mouse = 1
    touchpad {
        natural_scroll = no
    }
    sensitivity = 0
}

# General Layout
general {
    gaps_in = 3
    gaps_out = 6
    border_size = 2
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)
    layout = dwindle
}

# Decoration & Effects
decoration {
    rounding = 15
    blur {
        enabled = true
        size = 8
        passes = 4
    }
}

# Advanced Animations
animations {
    enabled = yes
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    animation = windows, 1, 7, myBezier
    animation = borderangle, 1, 15, linear, loop # FAST ANIMATED BORDER
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default, slide
}

# Layout Behavior
dwindle {
    pseudotile = yes
    preserve_split = yes
}

# Gestures
gesture = 3, horizontal, workspace

# Keybindings
$mainMod = SUPER
bind = $mainMod, Return, exec, kitty
bind = $mainMod, Q, killactive,
bind = $mainMod, M, exit,
bind = $mainMod, V, togglefloating,
bind = $mainMod, D, exec, wofi --show drun
bind = $mainMod, P, pseudo,
bind = $mainMod, J, togglesplit,
bind = $mainMod, L, exec, hyprlock
bind = $mainMod, F, fullscreen, 0 # Fullscreen
bind = $mainMod, Space, fullscreen, 1 # Maximize (keeps bar)
bind = $mainMod ALT, W, exec, ~/.config/bin/wallpaper_switcher
bind = $mainMod ALT, Y, exec, ~/.config/bin/theme_selector

# Application Shortcuts
bind = $mainMod SHIFT, A, exec, antigravity
bind = $mainMod SHIFT, B, exec, brave
bind = $mainMod SHIFT, F, exec, firefox
bind = $mainMod SHIFT, K, exec, keepassxc
bind = $mainMod SHIFT, D, exec, dolphin
bind = $mainMod SHIFT, C, exec, caido
bind = $mainMod, E, exec, kate  # Win+E for Kate
bind = $mainMod SHIFT, T, exec, kate  # Win+Shift+T for Kate (alternative)
bind = $mainMod SHIFT, O, exec, obsidian
bind = $mainMod SHIFT, E, exec, betterbird  # Win+Shift+E for Betterbird
bind = $mainMod SHIFT, P, exec, ~/.config/bin/power_profile_menu.sh  # Power profile selector

# Function Keys (F10/F11/F12)
bind = , F10, exec, playerctl play-pause  # Answer/Pause calls (Teams, Zoom, etc.)
bind = , F11, exec, playerctl stop  # End calls
bind = , F12, exec, brave

# Focus Navigation
bind = $mainMod, left, movefocus, l
bind = $mainMod, right, movefocus, r
bind = $mainMod, up, movefocus, u
bind = $mainMod, down, movefocus, d

# Workspaces
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5

# Media Keys (ThinkPad T14 Optimized)
bindel = , XF86AudioRaiseVolume, exec, pamixer -i 5 && notify-send -t 1000 "Volume: $(pamixer --get-volume)%"
bindel = , XF86AudioLowerVolume, exec, pamixer -d 5 && notify-send -t 1000 "Volume: $(pamixer --get-volume)%"
bindel = , XF86AudioMute, exec, pamixer -t && notify-send -t 1000 "Audio Muted"
bindel = , XF86AudioMicMute, exec, pamixer --default-source -t && notify-send -t 1000 "Mic Toggled"
bindel = , XF86MonBrightnessUp, exec, brightnessctl s +5% && notify-send -t 1000 "Brightness: $(brightnessctl g)"
bindel = , XF86MonBrightnessDown, exec, brightnessctl s 5%- && notify-send -t 1000 "Brightness: $(brightnessctl g)"
bind = , XF86WLAN, exec, nmcli radio wifi toggle && notify-send -t 1000 "WiFi Toggled"

# Screenshot Keys (grim + slurp + swappy)
bind = , Print, exec, grim -g "$(slurp)" - | swappy -f - && notify-send "Screenshot" "Editor opened"
bind = SHIFT, Print, exec, grim - | wl-copy && notify-send "Screenshot" "Fullscreen copied to clipboard"
bind = $mainMod, Print, exec, grim -g "$(slurp)" ~/Pictures/Screenshots/$(date +%Y%m%d_%H%M%S).png && notify-send "Screenshot" "Saved to Pictures/Screenshots"
bind = CTRL, Print, exec, grim ~/Pictures/Screenshots/$(date +%Y%m%d_%H%M%S).png && notify-send "Screenshot" "Fullscreen saved"

# Move to Workspace (Win + Alt)
bind = $mainMod ALT, 1, movetoworkspace, 1
bind = $mainMod ALT, 2, movetoworkspace, 2
bind = $mainMod ALT, 3, movetoworkspace, 3
bind = $mainMod ALT, 4, movetoworkspace, 4
bind = $mainMod ALT, 5, movetoworkspace, 5

# Mouse Binding
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# ─────────────────────────────────────────────────────────────────────────────
# WINDOW RULES (3.3 Official Block Syntax)
# ─────────────────────────────────────────────────────────────────────────────

windowrule {
    name = pavucontrol-float
    match:class = ^(pavucontrol)$
    float = yes
}

windowrule {
    name = blueman-float
    match:class = ^(blueman-manager)$
    float = yes
}

windowrule {
    name = network-float
    match:class = ^(nm-connection-editor)$
    float = yes
}

windowrule {
    name = polkit-float
    match:class = ^(org.kde.polkit-kde-authentication-agent-1)$
    float = yes
}

# Cybersecurity Tools Support
windowrule {
    name = zap-maximize
    match:class = ^(ZAP)$
    tile = yes
}

windowrule {
    name = burp-tile
    match:class = ^(burp-StartBurp)$
    tile = yes
}

windowrule {
    name = antigravity-center
    match:class = ^(Antigravity)$
    float = yes
    center = yes
}

windowrule {
    name = brave-auth
    match:title = ^(Brave)$
    tile = yes
}
